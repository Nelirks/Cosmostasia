[gd_scene load_steps=10 format=3 uid="uid://bdby3tlko6pkc"]

[ext_resource type="Script" path="res://scripts/combat/combat_scene.gd" id="1_t5omj"]
[ext_resource type="PackedScene" uid="uid://3uv7ywrnc8jk" path="res://scenes/combat_phase/hand_display.tscn" id="3_0g7ao"]
[ext_resource type="PackedScene" uid="uid://dypqama8wixgp" path="res://scenes/combat_phase/character_container.tscn" id="4_m72q4"]
[ext_resource type="PackedScene" uid="uid://dr8a6crxdqvbe" path="res://scenes/3d_environment/3d_board_scene.tscn" id="4_vhcko"]
[ext_resource type="PackedScene" uid="uid://lpnhcjsvs3n5" path="res://scenes/end_turn_button.tscn" id="6_22q0x"]
[ext_resource type="Script" path="res://scripts/mouse_click_area.gd" id="6_kni6t"]
[ext_resource type="Texture2D" uid="uid://csadrbq2b2p6f" path="res://resources/sprites/ui_elements/white_pixel.png" id="7_s64sb"]

[sub_resource type="Environment" id="Environment_bfeis"]
background_mode = 3
glow_enabled = true

[sub_resource type="ViewportTexture" id="ViewportTexture_mkcl4"]
viewport_path = NodePath("ArenaBackground/SubViewport")

[node name="CombatScene" type="Node3D"]
script = ExtResource("1_t5omj")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 20)
current = true
fov = 40.0

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_bfeis")

[node name="PlayerHand" parent="." instance=ExtResource("3_0g7ao")]
unique_name_in_owner = true
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, -6.5, 0)
is_player = true

[node name="OpponentHand" parent="." instance=ExtResource("3_0g7ao")]
unique_name_in_owner = true
transform = Transform3D(-0.5, 4.37114e-08, 0, -4.37114e-08, -0.5, 0, 0, 0, 0.5, 0, 6.5, 0)

[node name="CharacterContainer" parent="." instance=ExtResource("4_m72q4")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, -1)

[node name="ArenaBackground" type="TextureRect" parent="."]
offset_right = 40.0
offset_bottom = 40.0
texture = SubResource("ViewportTexture_mkcl4")

[node name="SubViewport" type="SubViewport" parent="ArenaBackground"]
own_world_3d = true
size = Vector2i(1920, 1080)

[node name="3dBoardScene" parent="ArenaBackground/SubViewport" instance=ExtResource("4_vhcko")]
unique_name_in_owner = true

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="TargetlessPlayArea" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 0
offset_right = 1920.0
offset_bottom = 800.0
mouse_filter = 1
script = ExtResource("6_kni6t")

[node name="EndTurnButton" parent="CanvasLayer" instance=ExtResource("6_22q0x")]
offset_left = 1650.0
offset_top = 480.0
offset_right = 1885.0
offset_bottom = 590.998

[node name="FadeInTexture" type="TextureRect" parent="CanvasLayer"]
unique_name_in_owner = true
self_modulate = Color(0.152941, 0.152941, 0.152941, 1)
offset_right = 1920.0
offset_bottom = 1080.0
texture = ExtResource("7_s64sb")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
light_energy = 0.05

[connection signal="card_selected" from="PlayerHand" to="CharacterContainer" method="on_card_selected"]
[connection signal="character_clicked" from="CharacterContainer" to="." method="_on_character_clicked"]
[connection signal="request_vfx" from="CharacterContainer" to="." method="play_vfx"]
[connection signal="clicked" from="CanvasLayer/TargetlessPlayArea" to="." method="_on_targetless_play_area_clicked"]
[connection signal="gui_input" from="CanvasLayer/TargetlessPlayArea" to="CanvasLayer/TargetlessPlayArea" method="_on_gui_input"]
[connection signal="pressed" from="CanvasLayer/EndTurnButton" to="." method="_on_end_turn_button_pressed"]
